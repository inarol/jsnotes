<!DOCTYPE html>
<html lang="zh-CN">

<head>
    <meta charset="UTF-8">
    <title>promise-1</title>
    <link rel="stylesheet" href="./css/icon.css">
</head>

<body>
    <div id="log"></div>
</body>
<script>
var pokemonToHTML = function(pokemon) {
    return "<span class='" + pokemon.icon + "'></span>";
};
var printLog = function(log) {
    document.getElementById("log").innerHTML = document.getElementById("log").innerHTML + log + "<br /><br />";
};
var pokemons = [{
    name: "小火龙",
    icon: "pokemon-1"
}, {
    name: "杰尼龟",
    icon: "pokemon-2"
}, {
    name: "妙蛙种子",
    icon: "pokemon-3"
}, {
    name: "皮卡丘",
    icon: "pokemon-4"
}];
var searchPokemon = new Promise(function(resolve, reject) {
	printLog("正在搜索附件的精灵...");
    setTimeout(function() {
        if (Math.random() > 0.2) {
            var pokemon = pokemons[Math.round(Math.random() * 3)];
            resolve(pokemon);
        } else {
            reject(new Error("附近没有精灵出没!!!"));
        }
    },1000);
});
searchPokemon.then(function(pokemon) {
    printLog("发现" + pokemonToHTML(pokemon) + ",赶紧捕捉吧！！");
}, function(result) {
    printLog(result);
});
</script>

</html>
